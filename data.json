public static void mergeDocxToPdf(List<DocumentModel> documents, String outputPdf) throws Exception {
    List<String> pdfFiles = new ArrayList<>();

    // Step 1: Convert each DOCX to PDF
    for (DocumentModel doc : documents) {
        byte[] decodedBytes = Base64.getDecoder().decode(doc.getFileContent());
        try (InputStream is = new ByteArrayInputStream(decodedBytes);
             XWPFDocument wordDoc = new XWPFDocument(is)) {

            String pdfPath = "temp_" + UUID.randomUUID() + ".pdf";
            convertDocxToPdf(wordDoc, pdfPath);
            pdfFiles.add(pdfPath);
        }
    }

    // Step 2: Merge PDFs
    mergePdfs(pdfFiles, outputPdf);

    // Step 3: Cleanup temp PDF files
    pdfFiles.forEach(file -> new File(file).delete());
}

private static void convertDocxToPdf(XWPFDocument docx, String outputPdf) throws Exception {
    try (FileOutputStream fos = new FileOutputStream(outputPdf);
         PdfWriter writer = new PdfWriter(fos);
         PdfDocument pdfDoc = new PdfDocument(writer);
         Document document = new Document(pdfDoc)) {

        docx.getParagraphs().forEach(p -> document.add(new Paragraph(p.getText())));
    }
}

private static void mergePdfs(List<String> pdfFiles, String outputPdf) throws IOException {
    try (PdfDocument mergedPdf = new PdfDocument(new PdfWriter(outputPdf))) {
        PdfMerger merger = new PdfMerger(mergedPdf);

        for (String pdfFile : pdfFiles) {
            try (PdfDocument pdf = new PdfDocument(new PdfReader(pdfFile))) {
                merger.merge(pdf, 1, pdf.getNumberOfPages());
            }
        }
    }
}



<dependencies>
    <!-- Apache POI for handling Word documents -->
    <dependency>
        <groupId>org.apache.poi</groupId>
        <artifactId>poi-ooxml</artifactId>
        <version>5.2.3</version>
    </dependency>

    <!-- iText for PDF conversion and merging -->
    <dependency>
        <groupId>com.itextpdf</groupId>
        <artifactId>itext7-core</artifactId>
        <version>7.2.5</version>
    </dependency>

    <!-- PDFBox (Alternative PDF manipulation library, optional) -->
    <dependency>
        <groupId>org.apache.pdfbox</groupId>
        <artifactId>pdfbox</artifactId>
        <version>2.0.29</version>
    </dependency>
</dependencies>
